apiVersion: v2
name: vault
description: A Helm chart for Kubernetes

type: application
version: 0.1.0
appVersion: "0.1.0"

dependencies:
  - name: vault
    version:  1.2.0
    repository: oci://registry-1.docker.io/bitnamicharts
    alias: vault
    condition: vault.enabled


vault write auth/kubernetes/config \
  token_reviewer_jwt="$(cat /var/run/secrets/kubernetes.io/serviceaccount/token)" \
  kubernetes_host="https://$KUBERNETES_PORT_443_TCP_ADDR:443" \
  kubernetes_ca_cert=@/var/run/secrets/kubernetes.io/serviceaccount/ca.crt